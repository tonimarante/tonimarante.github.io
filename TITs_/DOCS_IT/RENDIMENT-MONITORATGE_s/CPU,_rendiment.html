<!DOCTYPE html>
<html>
<head>
<link rel="Stylesheet" type="text/css" href="../../../style.css">
<link rel="alternate" type="application/rss+xml" title="RSS" href="../../../rss.xml">
<title>CPU,_rendiment</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
</head>
<body>

<div id="CPU, rendiment"><h2 id="CPU, rendiment" class="header"><a href="#CPU, rendiment">CPU, rendiment</a></h2></div>
<p>
*<span id="CPU, rendiment-Comprovar el rendiment de la CPU i entrada/sortida de dispositius i particions amb iostat"></span><strong id="Comprovar el rendiment de la CPU i entrada/sortida de dispositius i particions amb iostat">Comprovar el rendiment de la CPU i entrada/sortida de dispositius i particions amb iostat</strong>*<br />
Última modificació: maig de 2023<br />
</p>

<div id="sysstat"><h2 id="sysstat" class="header"><a href="#sysstat">sysstat</a></h2></div>
<p>
El paquet sysstat en proporciona tres eines de monitorització:<br />
</p>

<p>
	vmstat: ens  proporciona informació sobre la memòria, processos, paginació, block IO, traps i activitat de CPU i discs.<br />
	 sar: ens proporciona dades històriques de rendiment i ús de recursos d'un sistema<br />
	 iostat: ens proporciona informació sobre la CPU i dades de entrada i sortida de dispositius i particions<br />
</p>

<p>
Anem a veure com podem utilitzar iostat. Si l'executem obtindrem alguna cosa semblant a això:<br />
</p>

<p>
bmw@usbdes:~$ iostat<br />
Linux 3.16.0-44-generic (UBDESPTX)     13/09/15     _x86_64_    (2 CPU)<br />
</p>

<p>
avg-cpu:  %user   %nice %system %iowait  %steal   %idle<br />
</p>
<pre><code>5,58    0,15    1,31    0,90    0,00   92,06
</code></pre>

<p>
Device:            tps    kB_read/s    kB_wrtn/s    kB_read    kB_wrtn<br />
sda               2,90        47,31        92,93    5141358   10099544<br />
</p>

<p>
A la pàgina man de iostat s'explica amb detall que vol dir cada camp:<br />
</p>

<p>
  CPU Utilization Report<br />
</p>
<pre><code>The first report generated by the iostat command is the CPU Uti‐
lization Report. For multiprocessor systems, the CPU values  are
global  averages  among all processors.  The report has the fol‐
lowing format:
</code></pre>
<pre><code>%user
Show the percentage  of  CPU  utilization  that  occurred
while executing at the user level (application).
</code></pre>
<pre><code>%nice
Show  the  percentage  of  CPU  utilization that occurred
while executing at the user level with nice priority.
</code></pre>
<pre><code>%system
Show the percentage  of  CPU  utilization  that  occurred
while executing at the system level (kernel).
</code></pre>
<pre><code>%iowait
Show  the  percentage  of  time that the CPU or CPUs were
idle during which the system had an outstanding disk  I/O
request.
</code></pre>
<pre><code>%steal
Show  the percentage of time spent in involuntary wait by
the virtual CPU or CPUs while the hypervisor was  servic‐
ing another virtual processor.
</code></pre>
<pre><code>%idle
Show  the  percentage  of  time that the CPU or CPUs were
idle and the system did not have an outstanding disk  I/O
request.
</code></pre>

<p>
 Device Utilization Report<br />
</p>
<pre><code>The  second report generated by the iostat command is the Device
Utilization Report. The device report provides statistics  on  a
per physical device or partition basis. Block devices and parti‐
tions for which statistics are to be displayed may be entered on
the  command  line.  If no device nor partition is entered, then
statistics are displayed for every device used  by  the  system,
and  providing  that the kernel maintains statistics for it.  If
the ALL keyword is given on the command  line,  then  statistics
are  displayed for every device defined by the system, including
those that have never been used.  Transfer rates are shown in 1K
blocks  by default, unless the environment variable POSIXLY_COR‐
RECT is set, in which case 512-byte blocks are used.  The report
may show the following fields, depending on the flags used:
</code></pre>
<pre><code>Device:
This  column  gives  the  device  (or  partition) name as
listed in the /dev directory.
</code></pre>
<pre><code>tps
Indicate the number of transfers  per  second  that  were
issued to the device. A transfer is an I/O request to the
device. Multiple logical requests can be combined into  a
single  I/O request to the device. A transfer is of inde‐
terminate size.
</code></pre>
<pre><code>Blk_read/s (kB_read/s, MB_read/s)
Indicate  the  amount  of  data  read  from  the   device
expressed  in  a  number of blocks (kilobytes, megabytes)
per second. Blocks are equivalent to sectors  and  there‐
fore have a size of 512 bytes.
</code></pre>
<pre><code>Blk_wrtn/s (kB_wrtn/s, MB_wrtn/s)
Indicate  the  amount  of  data  written  to  the  device
expressed in a number of  blocks  (kilobytes,  megabytes)
per second.
</code></pre>
<pre><code>Blk_read (kB_read, MB_read)
The total number of blocks (kilobytes, megabytes) read.
</code></pre>
<pre><code>Blk_wrtn (kB_wrtn, MB_wrtn)
The  total  number of blocks (kilobytes, megabytes) writ‐
ten.
</code></pre>
<pre><code>rrqm/s
The number of read requests merged per second  that  were
queued to the device.
</code></pre>
<pre><code>wrqm/s
The  number of write requests merged per second that were
queued to the device.
</code></pre>
<pre><code>r/s
The number (after merges) of read requests completed  per
second for the device.
</code></pre>
<pre><code>w/s
The number (after merges) of write requests completed per
second for the device.
</code></pre>
<pre><code>rsec/s (rkB/s, rMB/s)
The number of sectors (kilobytes,  megabytes)  read  from
the device per second.
</code></pre>
<pre><code>wsec/s (wkB/s, wMB/s)
The  number  of sectors (kilobytes, megabytes) written to
the device per second.
</code></pre>
<pre><code>avgrq-sz
The average size (in sectors) of the requests  that  were
issued to the device.
</code></pre>
<pre><code>avgqu-sz
The average queue length of the requests that were issued
to the device.
</code></pre>
<pre><code>await
The average  time  (in  milliseconds)  for  I/O  requests
issued to the device to be served. This includes the time
spent by the requests in queue and the time spent servic‐
ing them.
</code></pre>
<pre><code>r_await
The  average  time  (in  milliseconds)  for read requests
issued to the device to be served. This includes the time
spent by the requests in queue and the time spent servic‐
ing them.
</code></pre>
<pre><code>w_await
The average time (in  milliseconds)  for  write  requests
issued to the device to be served. This includes the time
spent by the requests in queue and the time spent servic‐
ing them.
</code></pre>
<pre><code>svctm
The  average  service  time  (in  milliseconds)  for  I/O
requests that were issued to the device. Warning! Do  not
trust this field any more.  This field will be removed in
a future sysstat version.
</code></pre>
<pre><code>%util
Percentage of CPU time during  which  I/O  requests  were
issued  to  the  device  (bandwidth  utilization  for the
device). Device saturation  occurs  when  this  value  is
close to 100% for devices serving requests serially.  But
for devices serving requests in parallel,  such  as  RAID
arrays  and  modern  SSDs,  this  number does not reflect
their performance limits.
</code></pre>



<p>
Veure estadísitiques només de CPU:<br />
<code>iostat -c</code><br />
</p>

<p>
Veure estadísitiques només de I/O de disc:<br />
<code>iostat -d</code><br />
</p>

<p>
Veure estadísitiques d'un dispositiu determinat:<br />
<code>iostat -p sda (indicarem el dispositiu que vulguem)</code><br />
</p>

<p>
Veure estadísitiques de LVM:<br />
<code>iostat -N</code><br />
</p>


<div id="s-tui / stress"><h2 id="s-tui / stress" class="header"><a href="#s-tui / stress">s-tui / stress</a></h2></div>
<p>
Per a monitorar el rendiment de la CPU tenim l'eina s-tui, en combinació amb stress.<br />
És un programari ncurses. Les dues opcions principals que tenim son Monitor o Stress.<br />
Podem gravar també el resultat de les proves a un fitxer .csv:<br />
</p>
<pre><code><code>s-tui --csv-file test.csv</code>
</code></pre>

</body>
</html>
